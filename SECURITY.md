# Безопасность и CI/CD в Lapidar-BD

В этом документе описаны механизмы проверки кода на уязвимости и автоматизации процесса сборки и релиза после каждого коммита.

## Проверка безопасности кода

### Автоматическая проверка при коммите

В проекте настроен pre-commit хук, который автоматически проверяет код на наличие уязвимостей перед каждым коммитом. Это позволяет выявлять проблемы безопасности на ранней стадии разработки.

Для установки хуков выполните:

```bash
# Для Linux/Mac
./install-hooks.sh

# Для Windows
install-hooks.bat
```

### Проверка безопасности фронтенда

Фронтенд-код проверяется с помощью:

1. **ESLint с плагином безопасности** - статический анализ кода на наличие уязвимостей
2. **security-checks.js** - скрипт для проверки кода на потенциальные уязвимости
3. **npm audit** - проверка зависимостей на известные уязвимости

Для запуска проверки вручную:

```bash
cd web/frontend
npm run security-check
```

### Проверка безопасности бэкенда

Бэкенд-код проверяется с помощью:

1. **gosec** - статический анализатор безопасности для Go
2. **nancy** - проверка зависимостей Go на уязвимости

Для запуска проверки вручную:

```bash
gosec ./...
go list -json -deps ./... | nancy sleuth
```

## CI/CD пайплайн

В проекте настроен CI/CD пайплайн с использованием GitHub Actions, который автоматически выполняет следующие действия:

### При каждом пуше и пул-реквесте

1. **Линтинг кода** - проверка стиля кода
2. **Проверка безопасности** - анализ кода и зависимостей на уязвимости
3. **Тестирование** - запуск автоматических тестов
4. **Сборка** - компиляция бэкенда и фронтенда

### При пуше в основную ветку (main/master)

1. Выполняются все вышеперечисленные шаги
2. **Деплой** - автоматическое развертывание на продакшн-сервере

### При создании тега (релиза)

1. Выполняются все вышеперечисленные шаги
2. **Создание релиза** - сборка для различных платформ (Windows, Linux, macOS)
3. **Публикация релиза** - загрузка артефактов в GitHub Releases

## Структура CI/CD

Конфигурация CI/CD находится в файле `.github/workflows/ci-cd.yml` и включает следующие этапы:

- **lint**: Проверка стиля кода
- **security-scan**: Проверка безопасности кода и зависимостей
- **test**: Запуск автоматических тестов
- **build**: Сборка приложения
- **release**: Создание релиза (при создании тега)
- **deploy**: Деплой на продакшн (при пуше в основную ветку)

## Рекомендации по безопасности

1. Всегда запускайте проверки безопасности перед коммитом
2. Регулярно обновляйте зависимости
3. Следуйте принципам безопасной разработки
4. Не игнорируйте предупреждения от инструментов безопасности
5. При обнаружении уязвимостей исправляйте их немедленно

## Дополнительная информация

Для получения дополнительной информации о безопасности и CI/CD в проекте обратитесь к документации инструментов:

- [GitHub Actions](https://docs.github.com/en/actions)
- [ESLint Security Plugin](https://github.com/nodesecurity/eslint-plugin-security)
- [GoSec](https://github.com/securego/gosec)
- [Nancy](https://github.com/sonatype-nexus-community/nancy)